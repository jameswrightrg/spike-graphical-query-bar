{"version":3,"sources":["QueryBar.tsx","utils.ts","App.tsx","index.js"],"names":["AndOr","QueryBarInput","value","className","map","e","toJsxElement","element","type","And","QueryBar","useState","query","setQuery","toQueryBarElementsFromSobs","s","toQueryBarElementsFromSob","reduce","a","b","concat","split","p","components","toLowerCase","Or","valid","toQueryBarElement","queryBarElements","interpretedQuery","interpretBrackets","input","length","result","buffer","nestedLevel","i","push","console","log","toQueryBarElementsFromString","onChange","currentTarget","placeholder","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.30564179.chunk.js","sourcesContent":["import React, { useState } from \"react\";\r\nimport \"./QueryBar.css\";\r\nimport { interpretBrackets, StringOrBracketedString } from \"./utils\";\r\n\r\nenum AndOr {\r\n  And,\r\n  Or,\r\n}\r\n\r\ntype QueryBarInputElement =\r\n  | { type: \"AndOrSelector\"; value: AndOr }\r\n  | { type: \"Brackets\"; value: QueryBarInputElement[] }\r\n  | { type: \"Table\"; value: string; valid: boolean }\r\n  | { type: \"Pattern\"; value: string }\r\n  | { type: \"Tag\"; value: string }\r\n  | { type: \"string\"; value: string };\r\n\r\ninterface QueryBarInputProps {\r\n  value: QueryBarInputElement[];\r\n}\r\nfunction QueryBarInput({ value }: QueryBarInputProps) {\r\n  const toJsxElement = (element: QueryBarInputElement): JSX.Element => {\r\n    switch (element.type) {\r\n      case \"Brackets\":\r\n        return (\r\n          <div className=\"brackets\">\r\n            {element.value.map((e) => toJsxElement(e))}\r\n          </div>\r\n        );\r\n      case \"AndOrSelector\":\r\n        return (\r\n          <span className=\"andor-selector\">\r\n            {element.value === AndOr.And ? \"AND\" : \"OR\"}\r\n          </span>\r\n        );\r\n      case \"Table\":\r\n        return <span className=\"table-pill\">{element.value}</span>;\r\n      case \"Pattern\":\r\n        return (\r\n          <span className=\"column-name-pattern-pill\">{element.value}</span>\r\n        );\r\n      case \"Tag\":\r\n        return <span className=\"tag-pill\">{element.value}</span>;\r\n      case \"string\":\r\n        return <span>{element.value}</span>;\r\n      default:\r\n        return <span />;\r\n    }\r\n  };\r\n  return (\r\n    <div className=\"custom-input\">{value.map((e) => toJsxElement(e))}</div>\r\n  );\r\n}\r\n\r\nfunction QueryBar() {\r\n  const [query, setQuery] = useState<string>(\r\n    \"(table:Customer.Details AND pattern:%name%) or pattern:%customername% or tag:Name\"\r\n  );\r\n\r\n  const toQueryBarElement = (element: string): QueryBarInputElement => {\r\n    const components = element.split(\":\");\r\n    const type = components[0].toLowerCase();\r\n    switch (type) {\r\n      case \"and\":\r\n        return { type: \"AndOrSelector\", value: AndOr.And };\r\n      case \"or\":\r\n        return { type: \"AndOrSelector\", value: AndOr.Or };\r\n      case \"table\":\r\n        return { type: \"Table\", value: components[1], valid: true };\r\n      case \"pattern\":\r\n        return { type: \"Pattern\", value: components[1] };\r\n      case \"tag\":\r\n        return { type: \"Tag\", value: components[1] };\r\n      default:\r\n        return { type: \"string\", value: element };\r\n    }\r\n  };\r\n  const toQueryBarElementsFromString = (\r\n    query: string\r\n  ): QueryBarInputElement[] => {\r\n    const interpretedQuery = interpretBrackets(query);\r\n    console.log(interpretedQuery);\r\n    return toQueryBarElementsFromSobs(interpretedQuery);\r\n  };\r\n\r\n  const toQueryBarElementsFromSobs = (\r\n    query: StringOrBracketedString[]\r\n  ): QueryBarInputElement[] => {\r\n    return query\r\n      .map((s) => toQueryBarElementsFromSob(s))\r\n      .reduce(function (a, b) {\r\n        return a.concat(b);\r\n      });\r\n  };\r\n\r\n  const toQueryBarElementsFromSob = (\r\n    query: StringOrBracketedString\r\n  ): QueryBarInputElement[] => {\r\n    switch (query.type) {\r\n      case \"string\":\r\n        return query.value.split(\" \").map((p) => toQueryBarElement(p));\r\n      case \"bracketed-string\":\r\n        return [\r\n          { type: \"Brackets\", value: toQueryBarElementsFromSobs(query.value) },\r\n        ];\r\n    }\r\n  };\r\n\r\n  const queryBarElements = toQueryBarElementsFromString(query);\r\n  return (\r\n    <div className=\"field\">\r\n      <input\r\n        value={query}\r\n        onChange={(e) => setQuery(e.currentTarget.value)}\r\n        placeholder=\"Enter query here\"\r\n      ></input>\r\n      <QueryBarInput value={queryBarElements} />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default QueryBar;\r\n","export type StringOrBracketedString =\r\n  | { type: \"string\"; value: string }\r\n  | { type: \"bracketed-string\"; value: StringOrBracketedString[] };\r\n\r\nexport const interpretBrackets = (input: string): StringOrBracketedString[] => {\r\n  const length = input.length;\r\n\r\n  var result: StringOrBracketedString[] = [];\r\n\r\n  var buffer = \"\";\r\n  var nestedLevel = 0;\r\n  for (var i = 0; i < length; i++) {\r\n    if (input[i] === \"(\") {\r\n      if (nestedLevel === 0) {\r\n        result.push({ type: \"string\", value: buffer });\r\n        buffer = \"\";\r\n      } else {\r\n        buffer += input[i];\r\n      }\r\n      nestedLevel++;\r\n    } else if (input[i] === \")\") {\r\n      if (nestedLevel === 1) {\r\n        result.push({\r\n          type: \"bracketed-string\",\r\n          value: interpretBrackets(buffer),\r\n        });\r\n        buffer = \"\";\r\n      } else {\r\n        buffer += input[i];\r\n      }\r\n      if (nestedLevel >= 1) {\r\n        nestedLevel--;\r\n      }\r\n    } else {\r\n      buffer += input[i];\r\n    }\r\n  }\r\n  if (nestedLevel === 0) {\r\n    result.push({ type: \"string\", value: buffer });\r\n  } else {\r\n    result.push({ type: \"bracketed-string\", value: interpretBrackets(buffer) });\r\n  }\r\n\r\n  return result;\r\n};\r\n","import React from \"react\";\nimport \"./App.css\";\nimport QueryBar from \"./QueryBar\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <QueryBar />\n      </header>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}